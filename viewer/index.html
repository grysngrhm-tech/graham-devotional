<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The GRACE Bible</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css?v=8">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GRACE Bible">
    <link rel="apple-touch-icon" href="icons/icon-180.png">
    
    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32.png">
    <link rel="icon" type="image/svg+xml" href="icons/icon.svg">
</head>
<body>
    <div class="page-container index-page">
        <!-- Compact Header with Collapsible Breadcrumb -->
        <header class="compact-header" id="mainHeader">
            <!-- Primary header row -->
            <div class="header-row header-primary">
                <div class="header-left">
                    <h1 class="brand-title" id="brandTitle">
                        <span class="brand-text">The</span>
                        <span class="grace-toggle" id="graceToggle">
                            <span class="grace-collapsed">GRACE</span>
                            <span class="grace-expanded">
                                <span class="grace-word">Graham</span>
                                <span class="grace-word">Reimagined</span>
                                <span class="grace-word">Art &amp;</span>
                                <span class="grace-word">Canon</span>
                                <span class="grace-word">Experience</span>
                            </span>
                        </span>
                        <span class="brand-text">Bible</span>
                    </h1>
                </div>
                <div class="header-stats" id="statusFilter">
                    <button class="stat-btn active" data-status="all" title="Show all stories">
                        <span id="totalCount">‚Äî</span> Total
                    </button>
                    <button class="stat-btn" data-status="complete" title="Show complete stories">
                        <span id="completeCount">‚Äî</span> Complete
                    </button>
                    <button class="stat-btn" data-status="pending" title="Show pending stories">
                        <span id="pendingCount">‚Äî</span> Pending
                    </button>
                    <button class="theme-toggle" id="themeToggle" title="Toggle dark mode">
                        <span class="icon-sun">‚òÄÔ∏è</span>
                        <span class="icon-moon">üåô</span>
                    </button>
                </div>
            </div>
            
            <!-- Breadcrumb row - slides in after scrolling past section headers -->
            <div class="header-row header-breadcrumb" id="headerBreadcrumb">
                <span class="breadcrumb-testament" id="breadcrumbTestament"></span>
                <span class="breadcrumb-sep" id="breadcrumbSep1">‚Ä∫</span>
                <span class="breadcrumb-grouping" id="breadcrumbGrouping"></span>
                <span class="breadcrumb-sep" id="breadcrumbSep2">‚Ä∫</span>
                <span class="breadcrumb-book" id="breadcrumbBook"></span>
                <span class="breadcrumb-count" id="breadcrumbCount"></span>
            </div>
        </header>

        <!-- Introduction Section -->
        <section class="intro-section">
            <div class="intro-content">
                <div class="intro-column">
                    <h3 class="intro-heading">What It Is</h3>
                    <p class="intro-text">
                        The <span class="grace-accent">GRACE</span> Bible is a living illustrated devotional, presenting five hundred scenes from Genesis to Revelation. Each narrative is drawn from the World English Bible and enriched with select spoken quotations from the King James Version. Together, they form a single sweeping retelling of Scripture‚Äîfaithful to the text, vivid in detail, and crafted for modern readers seeking beauty, clarity, and reverence.
                    </p>
                </div>
                <div class="intro-column">
                    <h3 class="intro-heading">How It Works</h3>
                    <p class="intro-text">
                        Every story is accompanied by four AI-rendered sacred artworks shaped in the spirit of the great masters. Choose the image that speaks to you, or regenerate new interpretations when fresh inspiration arises. Each choice becomes part of the curated edition shared with all who explore this evolving, communal, and continually refined devotional experience.
                    </p>
                </div>
            </div>
        </section>

        <main class="main-content">
            <!-- Filter Section - Cascading Sliders -->
            <section class="filter-section">
                <!-- Row 1: Testament - Always visible -->
                <div class="filter-row testament-row">
                    <div class="segment-control" id="testamentFilter">
                        <button class="segment active" data-value="all">All</button>
                        <button class="segment" data-value="OT">Old Testament</button>
                        <button class="segment" data-value="NT">New Testament</button>
                    </div>
                </div>
                
                <!-- Row 2: Book Grouping - Hidden until OT/NT selected -->
                <div class="filter-row grouping-row" id="groupingFilterRow">
                    <div class="segment-control scrollable" id="groupingFilter">
                        <!-- Populated dynamically by JavaScript -->
                    </div>
                </div>
                
                <!-- Row 3: Individual Books - Hidden until grouping selected -->
                <div class="filter-row book-row" id="bookFilterRow">
                    <div class="segment-control scrollable" id="bookFilter">
                        <!-- Populated dynamically by JavaScript -->
                    </div>
                </div>
                
                <!-- Row 4: Search + Surprise -->
                <div class="filter-row search-row">
                    <div class="search-wrapper">
                        <svg class="search-icon" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                        </svg>
                        <input type="search" id="searchInput" placeholder="Search titles or verses...">
                        <kbd class="search-shortcut">‚åòK</kbd>
                    </div>
                    
                    <button class="surprise-btn" id="surpriseBtn" title="Go to a random story">
                        üé≤ Surprise Me
                    </button>
                </div>
            </section>
            
            <!-- Active Filters & Results Count -->
            <section class="filter-feedback">
                <div class="active-filters" id="activeFilters">
                    <!-- Populated by JavaScript -->
                </div>
                <div class="results-count">
                    Showing <span id="resultsCount">‚Äî</span> stories
                </div>
            </section>

            <!-- Stories Grid -->
            <section class="stories-grid" id="storiesGrid">
                <!-- Cards populated by JavaScript -->
            </section>
        </main>

        <!-- Skeleton Card Template -->
        <template id="skeletonTemplate">
            <div class="story-card skeleton">
                <div class="card-image skeleton-shimmer"></div>
                <div class="card-content">
                    <div class="skeleton-title skeleton-shimmer"></div>
                    <div class="skeleton-meta skeleton-shimmer"></div>
                </div>
            </div>
        </template>

        <footer class="site-footer">
            <p>
                <span class="footer-brand">The <span class="grace-accent">GRACE</span> Bible</span>
                <span class="footer-tagline"><span class="grace-accent">Graham Reimagined Art & Canon Experience</span></span>
                <span class="footer-divider"></span>
                <span class="footer-copyright">A Family Devotional Project</span>
            </p>
        </footer>
    </div>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <script src="app.js?v=7"></script>
</body>
</html>
